-- == SERVICES UND GRUNDVARIABLEN ==
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local autoKill1Whitelist = {}
local autoKill1Blacklist = {}

-- == REMOTES/PARTS HOLEN ==
local muscleEvent = player:WaitForChild("muscleEvent")
local interactSeat = workspace:WaitForChild("machinesFolder"):WaitForChild("Jungle Bar Lift"):WaitForChild("interactSeat")

-- == Elerium-GUI LADEN ==
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/obeseinsect/roblox/main/Ui%20Libraries/Elerium.lua"))()

-- == GUI-FENSTER ==
local Window = library:AddWindow("Muki's private", {
    main_color = Color3.fromRGB(100, 100, 255),
    min_size = Vector2.new(400, 400),
    toggle_key = Enum.KeyCode.RightShift,
    can_resize = true,
})

-- == TABS ==
local mainTab = Window:AddTab("Main")
local killTab = Window:AddTab("Auto Kill")
local rebirthTab = Window:AddTab("Rebirth")
local farmingTab = Window:AddTab("Farming")
local manageTab = Window:AddTab("Player WL/BL")

manageTab:AddLabel("by Muki")
mainTab:AddLabel("by Muki")
killTab:AddLabel("by Muki")
rebirthTab:AddLabel("by Muki")
farmingTab:AddLabel("by Muki")

-- == PLAYER WL/BL DROPDOWN (dynamisch) ==
local selectedPlayer = nil

manageTab:AddDropdown("Spieler auswählen", {}, function(name)
    selectedPlayer = name
end, function()
    local names = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            table.insert(names, plr.Name)
        end
    end
    return names
end)

manageTab:AddButton("Whitelist ausgewählter Spieler", function()
    if not selectedPlayer then return end
    local plr = Players:FindFirstChild(selectedPlayer)
    if plr then
        autoKill1Whitelist[plr.UserId] = true
        autoKill1Blacklist[plr.UserId] = nil
        print(plr.Name .. " auf Whitelist für Auto Kill 1.")
    end
end)

manageTab:AddButton("Blacklist ausgewählter Spieler", function()
    if not selectedPlayer then return end
    local plr = Players:FindFirstChild(selectedPlayer)
    if plr then
        autoKill1Blacklist[plr.UserId] = true
        autoKill1Whitelist[plr.UserId] = nil
        print(plr.Name .. " auf Blacklist für Auto Kill 1.")
    end
end)

-- == AUTO MUSCLE (Auto Lift) ==
local autoMuscleEnabled = false
mainTab:AddSwitch("Auto Lift", function(state)
    autoMuscleEnabled = state
end)
task.spawn(function()
    while true do
        if autoMuscleEnabled then
            pcall(function()
                muscleEvent:FireServer("rep", interactSeat)
            end)
        end
        task.wait(0.1)
    end
end)

-- == AUTO KILL 1 == (mit WL/BL)
local autoKillEnabled = false
killTab:AddSwitch("Auto Kill", function(state)
    autoKillEnabled = state
end)
RunService.RenderStepped:Connect(function()
    if not autoKillEnabled then return end
    local character = player.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then return end
    local hrp = character.HumanoidRootPart
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            -- Whitelist/Blacklist-Logik:
            if autoKill1Whitelist[plr.UserId] then continue end
            if next(autoKill1Blacklist) and not autoKill1Blacklist[plr.UserId] then continue end
            local db = plr.Character:FindFirstChild("DamageBox") or plr.Character:FindFirstChild("RightHand")
            if db and db:IsA("BasePart") then
                db.CFrame = hrp.CFrame * CFrame.new(0, 0, -2)
            end
        end
    end
end)

-- == AUTO KILL 2 ==
local autoKill2Enabled = false
killTab:AddSwitch("Auto Kill 2", function(state)
    autoKill2Enabled = state
end)
local function useTool()
    local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
    if tool and tool:FindFirstChild("RemoteEvent") then
        tool.RemoteEvent:FireServer()
    elseif tool then
        tool:Activate()
    end
end
RunService.RenderStepped:Connect(function()
    if not autoKill2Enabled then return end
    local character = player.Character
    if not character then return end
    local myHitbox = character:FindFirstChild("RightHand") or character:FindFirstChild("DamageBox")
    if not myHitbox then return end
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local targetBox = plr.Character:FindFirstChild("DamageBox") or plr.Character:FindFirstChild("HumanoidRootPart")
            if targetBox and targetBox:IsA("BasePart") then
                myHitbox.CFrame = targetBox.CFrame * CFrame.new(0, 0, -1)
                useTool()
                task.wait(0.05)
            end
        end
    end
end)

-- == AUTO REBIRTH ==
local autoRebirthEnabled = false
rebirthTab:AddSwitch("Auto Rebirth", function(state)
    autoRebirthEnabled = state
end)
task.spawn(function()
    while true do
        if autoRebirthEnabled then
            pcall(function()
                ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
            end)
            task.wait(0.3)
        end
        task.wait(0.1)
    end
end)

-- == AUTO KING (Position Lock zu fester King-Position) ==
local autoKingEnabled = false
local kingPosition = Vector3.new(-8739.369140625, 23.401443481445312, -5846.9326171875)
rebirthTab:AddSwitch("Auto King", function(state)
    autoKingEnabled = state
end)
task.spawn(function()
    while true do
        if autoKingEnabled then
            local char = player.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                char.HumanoidRootPart.CFrame = CFrame.new(kingPosition)
            end
        end
        task.wait(0.1)
    end
end)

-- == ANTI AFK ==
local antiAFKEnabled = false
mainTab:AddSwitch("Anti AFK", function(state)
    antiAFKEnabled = state
end)
task.spawn(function()
    local vu = game:GetService("VirtualUser")
    player.Idled:Connect(function()
        if antiAFKEnabled then
            vu:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
            task.wait(1)
            vu:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
        end
    end)
end)

-- == POSITION LOCK (Main Tab) ==
local posLockEnabled = false
local lockedPosition = nil
mainTab:AddSwitch("Position Lock", function(state)
    posLockEnabled = state
    if state then
        local char = player.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            lockedPosition = char.HumanoidRootPart.Position
        end
    end
end)
task.spawn(function()
    while true do
        if posLockEnabled and lockedPosition then
            local char = player.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                char.HumanoidRootPart.CFrame = CFrame.new(lockedPosition)
            end
        end
        task.wait(0.1)
    end
end)
